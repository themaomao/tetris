{"ast":null,"code":"import _objectSpread from\"/Volumes/React Project/All Project/All React Project/tetrisprac-one-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{hasCollision,isWithinBoard}from\"../Business/Board\";import{rotate}from\"./Tetrominoes\";import{Action}from\"../Business/Input\";var attemptRotation=function attemptRotation(_ref){var board=_ref.board,player=_ref.player,setPlayer=_ref.setPlayer;var shape=rotate({piece:player.tetromino.shape,direction:1});var position=player.position;var isValidRotation=isWithinBoard({board:board,position:position,shape:shape})&&!hasCollision({board:board,position:position,shape:shape});if(isValidRotation){setPlayer(_objectSpread(_objectSpread({},player),{},{tetromino:_objectSpread(_objectSpread({},player.tetromino),{},{shape:shape})}));}else{return false;}};export var movePlayer=function movePlayer(_ref2){var delta=_ref2.delta,position=_ref2.position,shape=_ref2.shape,board=_ref2.board;var desiredNextPosition={row:position.row+delta.row,column:position.column+delta.column};var collided=hasCollision({board:board,position:desiredNextPosition,shape:shape});var isOnBoard=isWithinBoard({board:board,position:desiredNextPosition,shape:shape});var preventMove=!isOnBoard||isOnBoard&&collided;var nextPosition=preventMove?position:desiredNextPosition;var isMovingDown=delta.row>0;var isHit=isMovingDown&&(collided||!isOnBoard);return{collided:isHit,nextPosition:nextPosition};};var attemptMovement=function attemptMovement(_ref3){var board=_ref3.board,action=_ref3.action,player=_ref3.player,setPlayer=_ref3.setPlayer,setGameOver=_ref3.setGameOver;var delta={row:0,column:0};var isFastDropping=false;if(action===Action.FastDrop){isFastDropping=true;}else if(action===Action.SlowDrop){delta.row+=1;}else if(action===Action.Left){delta.column-=1;}else if(action===Action.Right){delta.column+=1;}var _movePlayer=movePlayer({delta:delta,position:player.position,shape:player.tetromino.shape,board:board}),collided=_movePlayer.collided,nextPosition=_movePlayer.nextPosition;// Did we collide immediately? If so, game over, man!\nvar isGameOver=collided&&player.position.row===0;if(isGameOver){setGameOver(isGameOver);}setPlayer(_objectSpread(_objectSpread({},player),{},{collided:collided,isFastDropping:isFastDropping,position:nextPosition}));};export var playerController=function playerController(_ref4){var action=_ref4.action,board=_ref4.board,player=_ref4.player,setPlayer=_ref4.setPlayer,setGameOver=_ref4.setGameOver;if(!action)return;if(action===Action.Rotate){attemptRotation({board:board,player:player,setPlayer:setPlayer});}else{attemptMovement({board:board,player:player,setPlayer:setPlayer,action:action,setGameOver:setGameOver});}};","map":{"version":3,"names":["hasCollision","isWithinBoard","rotate","Action","attemptRotation","_ref","board","player","setPlayer","shape","piece","tetromino","direction","position","isValidRotation","_objectSpread","movePlayer","_ref2","delta","desiredNextPosition","row","column","collided","isOnBoard","preventMove","nextPosition","isMovingDown","isHit","attemptMovement","_ref3","action","setGameOver","isFastDropping","FastDrop","SlowDrop","Left","Right","_movePlayer","isGameOver","playerController","_ref4","Rotate"],"sources":["/Volumes/React Project/All Project/All React Project/tetrisprac-one-react/src/Business/PlayerController.js"],"sourcesContent":["import { hasCollision, isWithinBoard } from \"../Business/Board\";\nimport { rotate } from \"./Tetrominoes\";\nimport { Action } from \"../Business/Input\";\n\nconst attemptRotation = ({ board, player, setPlayer }) => {\n  const shape = rotate({\n    piece: player.tetromino.shape,\n    direction: 1\n  });\n\n  const position = player.position;\n  const isValidRotation =\n    isWithinBoard({ board, position, shape }) &&\n    !hasCollision({ board, position, shape });\n\n  if (isValidRotation) {\n    setPlayer({\n      ...player,\n      tetromino: {\n        ...player.tetromino,\n        shape\n      }\n    });\n  } else {\n    return false;\n  }\n};\n\nexport const movePlayer = ({ delta, position, shape, board }) => {\n  const desiredNextPosition = {\n    row: position.row + delta.row,\n    column: position.column + delta.column\n  };\n\n  const collided = hasCollision({\n    board,\n    position: desiredNextPosition,\n    shape\n  });\n\n  const isOnBoard = isWithinBoard({\n    board,\n    position: desiredNextPosition,\n    shape\n  });\n\n  const preventMove = !isOnBoard || (isOnBoard && collided);\n  const nextPosition = preventMove ? position : desiredNextPosition;\n\n  const isMovingDown = delta.row > 0;\n  const isHit = isMovingDown && (collided || !isOnBoard);\n\n  return { collided: isHit, nextPosition };\n};\n\nconst attemptMovement = ({ board, action, player, setPlayer, setGameOver }) => {\n  const delta = { row: 0, column: 0 };\n  let isFastDropping = false;\n\n  if (action === Action.FastDrop) {\n    isFastDropping = true;\n  } else if (action === Action.SlowDrop) {\n    delta.row += 1;\n  } else if (action === Action.Left) {\n    delta.column -= 1;\n  } else if (action === Action.Right) {\n    delta.column += 1;\n  }\n\n  const { collided, nextPosition } = movePlayer({\n    delta,\n    position: player.position,\n    shape: player.tetromino.shape,\n    board\n  });\n\n  // Did we collide immediately? If so, game over, man!\n  const isGameOver = collided && player.position.row === 0;\n  if (isGameOver) {\n    setGameOver(isGameOver);\n  }\n\n  setPlayer({\n    ...player,\n    collided,\n    isFastDropping,\n    position: nextPosition\n  });\n};\n\nexport const playerController = ({\n  action,\n  board,\n  player,\n  setPlayer,\n  setGameOver\n}) => {\n  if (!action) return;\n\n  if (action === Action.Rotate) {\n    attemptRotation({ board, player, setPlayer });\n  } else {\n    attemptMovement({ board, player, setPlayer, action, setGameOver });\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}